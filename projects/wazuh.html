<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wazuh SIEM & Agent – Honeypot Monitoring</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background: #0f172a;
      color: #cbd5e1;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    h1, h2, h3 {
      color: #38bdf8;
    }
    .section {
      background: #172133;
      padding: 2em;
      margin-bottom: 2em;
      border-radius: 14px;
      border: 1px solid #23314d;
    }
    pre {
      background: #1e293b;
      color: #a5f3fc;
      padding: 1em;
      border-radius: 8px;
      white-space: pre-wrap;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th, td {
      border: 1px solid #23314d;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #1e293b;
      color: #38bdf8;
    }
    .warning {
      background: #7f1d1d;
      border: 1px solid #dc2626;
      padding: 1em;
      border-radius: 8px;
      margin-top: 1em;
    }
    .footer {
      text-align: center;
      opacity: 0.6;
      margin-top: 3em;
    }
  </style>
</head>

<body>
<div class="container">

  <h1 class="text-center mt-5 mb-3">
    Wazuh SIEM & Agent for Honeypot Monitoring
  </h1>
  <p class="text-center">
    Experimenter: Lyam<br>
    OS: Ubuntu Server 22.04 LTS<br>
    Tools: Wazuh 4.x, Wazuh Dashboard
  </p>

  <!-- 1. Introduction -->
  <div class="section">
    <h2>1. Introduction</h2>
    <p>
      Wazuh adalah platform open-source SIEM dan XDR yang digunakan
      untuk monitoring keamanan, analisis log terpusat, dan deteksi
      ancaman secara real-time. Integrasi dengan Cowrie Honeypot
      memungkinkan analisis mendalam terhadap aktivitas attacker.
    </p>
  </div>

  <!-- 2. Architecture -->
  <div class="section">
    <h2>2. Lab Architecture</h2>
    <pre>
Wazuh Server (Manager + Dashboard)
IP : 192.168.56.120

Cowrie Honeypot (Wazuh Agent)
IP : 192.168.56.110

Flow:
Attacker → Cowrie → Wazuh Agent → Wazuh Manager → Dashboard
    </pre>
  </div>

  <!-- 3. Server Installation -->
  <div class="section">
    <h2>3. Wazuh Server Installation</h2>
    <pre>
sudo apt update && sudo apt upgrade -y
sudo apt install -y curl apt-transport-https unzip wget
    </pre>

    <pre>
curl -sO https://packages.wazuh.com/4.7/wazuh-install.sh
sudo bash wazuh-install.sh -a
    </pre>
  </div>

  <!-- 4. Dashboard -->
  <div class="section">
    <h2>4. Wazuh Dashboard Access</h2>
    <pre>
URL      : https://192.168.56.120
Username : admin
Password : generated during installation
    </pre>
  </div>

  <!-- 5. Firewall -->
  <div class="section">
    <h2>5. Firewall Configuration</h2>
    <pre>
sudo ufw allow 1514/tcp
sudo ufw allow 1515/tcp
sudo ufw allow 443/tcp
sudo ufw allow 55000/tcp
sudo ufw reload
    </pre>
  </div>

  <!-- 6. Agent Installation -->
  <div class="section">
    <h2>6. Wazuh Agent Installation (Honeypot)</h2>
    <pre>
curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | \
sudo gpg --dearmor -o /usr/share/keyrings/wazuh.gpg

echo "deb [signed-by=/usr/share/keyrings/wazuh.gpg] \
https://packages.wazuh.com/4.x/apt/ stable main" | \
sudo tee /etc/apt/sources.list.d/wazuh.list

sudo apt update
WAZUH_MANAGER="192.168.56.120" sudo apt install wazuh-agent -y
    </pre>
  </div>

  <!-- 7. Cowrie Logs -->
  <div class="section">
    <h2>7. Cowrie Log Monitoring</h2>
    <pre>
<localfile>
  <log_format>json</log_format>
  <location>/home/cowrie/cowrie/var/log/cowrie/cowrie.json</location>
</localfile>
    </pre>
  </div>

  <!-- 8. Custom Rules -->
  <div class="section">
    <h2>8. Custom Decoders & Rules</h2>
    <pre>
Rule ID Range : 100100 - 100199

Critical Events:
- Successful login
- Brute force attack
- Command execution
- Malware download
    </pre>
  </div>

  <!-- 9. Dashboard -->
  <div class="section">
    <h2>9. Dashboard Visualization</h2>
    <ul>
      <li>Top attacking IPs</li>
      <li>Attack timeline</li>
      <li>Executed commands</li>
      <li>Malware download attempts</li>
    </ul>
  </div>

  <!-- 10. Testing -->
  <div class="section">
    <h2>10. Integration Testing</h2>
    <pre>
hydra -l root -P rockyou.txt ssh://192.168.56.110
ssh root@192.168.56.110
    </pre>
  </div>

  <!-- 11. Security -->
  <div class="section">
    <h2>11. Security Considerations</h2>
    <div class="warning">
      <ul>
        <li>Isolate SIEM network</li>
        <li>Limit dashboard access</li>
        <li>Enable alerts only for high severity</li>
        <li>Backup logs regularly</li>
      </ul>
    </div>
  </div>

  <!-- 12. Conclusion -->
  <div class="section">
    <h2>12. Conclusion</h2>
    <p>
      Integrasi Wazuh SIEM dengan Cowrie Honeypot berhasil dilakukan.
      Sistem mampu mendeteksi serangan, menganalisis aktivitas attacker,
      dan memberikan alert secara real-time.
    </p>

    <p><b>Status:</b> Fully Operational ✅</p>
    <p><b>Monitoring:</b> Active 24/7</p>
  </div>

  <div class="footer">
    Wazuh SIEM Integration — Cybersecurity Monitoring Lab
  </div>

</div>
</body>
</html>
